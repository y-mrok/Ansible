.. _bekitousei:

##################################################
冪等性（べきとうせい）
##################################################

.. _bekitousei-toha:

**************************************************
冪等性とは
**************************************************
「ある操作を 1 回行っても複数回行っても結果が同じになる」ことです。

Ansible の最大の特徴は冪等性です。同じプレイブックを何度実行しても、実行後の管理対象ノードは常に同じ状態になります。この特徴により、プレイの途中でタスクの実行に失敗しても途中のタスクから実行を再開する必要はなく、最初のタスクからやり直せます。誤って同じプレイブックを複数回実行しても問題ありません。

.. _bekitousei-no-kakuin:

**************************************************
冪等性の確認
**************************************************
次のインベントリファイルとプレイブックの実行結果で冪等性を確認します。

- インベントリファイル：hosts.yml

.. literalinclude:: ./yaml/hosts1.yml
   :language: yaml

- プレイブックファイル：web.yml

.. literalinclude:: ./yaml/web.yml
   :language: yaml

1 回目の実行ログです。管理対象ノードの状態を変更したタスクの実行結果は "changed" になっています。

.. literalinclude:: ./log/web.log
   :language: none

2 回目の実行ログです。 1 回目の実行で管理対象ノードは変更済みであるため、すべてのタスクの実行結果は "ok" になっています。

.. literalinclude:: ./log/web2.log
   :language: none

1 回目と 2 回目の実行結果から、Ansible の冪等性を確認できます。
